# beholdiam

beholdiam uses [Athena](https://docs.aws.amazon.com/athena/latest/ug/what-is.html) to query your [CloudTrail](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-getting-started.html) log bucket and determine which users and roles are being actively used.  beholdiam uses this list of active users and roles to determine which actions have been used by each of them, and generates IAM policies recommendations.    

Note that [not all AWS services](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-aws-service-specific-topics.html) are supported by CloudTrail.  Also note that, [by default, trails log all management events and don't include data events.](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-management-and-data-events-with-cloudtrail.html)  This means that IAM policies generated by Behold may be incomplete and need a bit of tuning.  (Use caution when removing IAM actions from resources in your environments.)    

## Installation
```
pip install beholdiam
```
Requirements:
- python 3.6+

## AWS  Setup
- CloudTrail logs must be enabled and configured to log to S3.
- A new S3 bucket must be created to store output for beholdiam.
- A user or role must be configured configured for beholdiam to use Athena and S3.  See [example policy](examples/beholdiam-policy.json).

## Usage
beholdiam requires a metadata file to be configured.  Feel free to use the [example metadata](examples/metadata.yml) as a reference.

